# 智能文件处理系统功能详细文档

## 概述

智能文件处理系统是单词筛选工具的核心数据输入模块，负责从多种格式的文件中提取、清洗和验证单词数据。该系统通过FileUtils类实现，为用户提供无缝的文件处理体验。

## 核心功能架构

### 1. 多格式文件支持

**支持的文件格式：**
- TXT文本文件（UTF-8编码）
- Excel文件（.xlsx, .xls）
- CSV文件（通过accept属性支持）

**文件格式检测流程：**
```
用户选择文件 → 提取文件扩展名 → 验证格式支持 → 选择对应解析器
```

**文件大小限制：**
- 最大文件大小：10MB
- 实时文件大小验证
- 超限时显示友好错误提示

### 2. 智能文本预处理系统

#### 2.1 音标格式处理
**功能描述：** 自动识别并分离音标内容

**处理规则：**
- 识别格式：`word[phonetic]` → `word [phonetic]`
- 正则表达式：`/([a-zA-ZÀ-ÿ'.-]+)(\[[^\]]+\])/g`
- 处理结果：在单词和音标之间插入空格，便于后续分割

**示例转换：**
```
输入：hello[həˈloʊ]world[wɜːrld]
输出：hello [həˈloʊ] world [wɜːrld]
```

#### 2.2 特殊字符清理
**功能描述：** 清理影响单词识别的特殊字符

**清理规则：**
- 目标字符：引号(")、反斜杠(\)、中文顿号(、)
- 替换策略：将特殊字符替换为空格
- 正则表达式：`/["\\、]/g`

#### 2.3 智能单词分割
**功能描述：** 使用多种分界符分割文本为单词

**分割规则：**
- 分界符：空格、制表符、逗号、分号
- 正则表达式：`/[\s,;]+/`
- 后处理：去除空白、过滤空字符串

### 3. 单词验证系统

#### 3.1 基础验证规则
**长度检查：**
- 最小长度：1个字符
- 最大长度：50个字符
- 超出范围的单词被标记为无效

#### 3.2 音标格式验证
**音标识别：**
- 格式要求：`[音标内容]`
- 支持字符：英文字母、重音符号、IPA音标符号
- IPA符号集：ˈˌːəɪɛæʌɔʊɑɒɜɝɞ等专业音标字符

#### 3.3 普通单词验证
**字符要求：**
- 允许字符：英文字母（a-z, A-Z）
- 重音字符：À-ÿ（涵盖欧洲语言重音符号）
- 标点符号：撇号(')、连字符(-)、句点(.)
- 必须包含至少一个字母（不能纯标点）

### 4. 数据统计与去重

#### 4.1 重复检测
**去重策略：**
- 基于小写转换的重复检测
- 保留首次出现的单词（保持原始大小写）
- 统计重复单词数量

#### 4.2 统计信息生成
**统计指标：**
- 总提取单词数（包含重复和无效）
- 有效单词数（去重后）
- 重复单词数
- 无效单词数
- 无效单词示例（最多10个）
- 预处理步骤示例（最多5个）

### 5. Excel文件专用处理

#### 5.1 多工作表支持
**处理流程：**
```
读取Excel文件 → 遍历所有工作表 → 转换为JSON数组 → 逐行逐列处理
```

#### 5.2 单元格数据提取
**提取规则：**
- 只处理字符串类型单元格
- 跳过空单元格和非文本内容
- 应用与文本文件相同的预处理流程

### 6. 结果导出系统

#### 6.1 文本格式导出
**导出内容结构：**
```
导出信息头部
├── 源文件信息
├── 规则信息
├── 统计数据
└── 时间戳

单词内容
├── 分组格式（如有）
└── 单词列表
```

#### 6.2 Excel格式导出
**工作表结构：**
- 信息区域：导出元数据
- 数据区域：单词列表或分组数据
- 表头设计：根据是否有分组自动调整列结构

**分组支持：**
- 一级分组：[分组, 单词]
- 二级分组：[一级分组, 二级分组, 单词]

### 7. 错误处理与用户反馈

#### 7.1 文件读取错误
**错误类型：**
- 文件格式不支持
- 文件大小超限
- 文件读取失败
- 编码问题

#### 7.2 用户友好提示
**反馈机制：**
- 实时处理进度显示
- 详细的错误信息
- 预处理步骤展示
- 统计结果可视化

## 处理流程图

```
文件选择
    ↓
格式验证 → [不支持] → 错误提示
    ↓ [支持]
大小检查 → [超限] → 错误提示
    ↓ [通过]
文件读取
    ↓
内容解析 → TXT解析器 / Excel解析器
    ↓
文本预处理
    ├── 音标分离
    ├── 字符清理
    └── 单词分割
    ↓
单词验证
    ├── 长度检查
    ├── 格式验证
    └── 字符验证
    ↓
数据整理
    ├── 去重处理
    ├── 统计生成
    └── 结果封装
    ↓
用户反馈
    ├── 成功提示
    ├── 统计展示
    └── 预处理信息
```

## 使用指南与注意事项

### 1. 文件准备建议
**文件格式选择：**
- 推荐使用UTF-8编码的TXT文件
- Excel文件适合结构化数据
- 确保文件大小不超过10MB

**数据格式规范：**
- 单词间使用空格、逗号或分号分隔
- 音标使用方括号格式：`word[phonetic]`
- 避免使用特殊字符如引号、反斜杠

### 2. 常见问题处理
**编码问题：**
- 如出现乱码，请确保文件为UTF-8编码
- 可使用记事本另存为UTF-8格式

**格式识别：**
- 系统会自动识别音标格式并分离
- 特殊字符会被自动清理
- 重复单词会被自动去重

### 3. 数据质量优化
**预处理效果：**
- 查看预处理步骤了解数据转换过程
- 检查无效单词示例识别数据问题
- 利用统计信息评估数据质量

**结果验证：**
- 对比处理前后的单词数量
- 检查去重效果是否符合预期
- 确认音标分离是否正确

### 4. 性能优化建议
**大文件处理：**
- 建议将超大文件分割为多个小文件
- 避免在一个文件中混合多种格式
- 定期清理临时文件释放内存

**批量处理：**
- 可以连续处理多个文件
- 每次处理完成后查看统计信息
- 根据需要调整文件格式和内容

该系统为整个单词筛选工具提供了坚实的数据基础，确保后续的规则处理和结果分析能够基于高质量的数据进行。