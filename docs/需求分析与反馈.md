# 单词工具待修改需求分析与反馈

## 文档概述
本文档基于2025年5月30日更新的待修改list，对各项需求进行详细分析，包括修改建议、补充说明、难度评估和优先级排序。

## 需求分类与分析

### 一、主页功能性需求

#### 1. 筛选结果预处理（删除）功能 ✅ **已完成**
**需求描述：**
- 在筛选结果预览中增加单词删除功能
- 每个单词旁边添加红色删除按钮
- 点击删除后单词标灰，按钮变为恢复按钮
- 统计区显示已预删除的单词数
- 导出时排除预删除的单词

**难度评估：** 中等（3/5）
**优先级：** 高
**技术要点：**
- 需要扩展数据结构，添加删除状态标记
- UI交互逻辑相对复杂
- 需要修改导出逻辑

**修改建议：**
- 建议使用`deleted: boolean`字段标记删除状态
- 删除按钮可使用Font Awesome图标或SVG
- 统计显示格式："筛选结果：500个单词 (-7)"

#### 2. 排序功能测试与文档 ⭐⭐⭐
**需求描述：** 目前排序功能未充分测试，需要完善文档
**难度评估：** 低（2/5）
**优先级：** 中
**建议：** 优先完成其他功能后再处理

#### 3. 导出文件头部信息增强 ✅
**状态：** 已完成（v1.0.2版本）
**包含内容：** 源文件信息、筛选规则、生成时间

#### 4. 规则预览同步问题 ⭐⭐
**需求描述：** 规则预览中的全局集合定义与规则管理不同步
**难度评估：** 低（2/5）
**优先级：** 中
**建议：** 检查数据同步机制，确保一致性

#### 5. 滚动条位置重置 ⭐⭐
**需求描述：** 更换筛选模式后，预览区滚动条应回到顶部
**难度评估：** 低（1/5）
**优先级：** 低
**实现方案：** 在生成新结果时调用`scrollTop = 0`

### 二、规则管理页功能性需求

#### 1. 扩展测试规则单词库到20个 ⭐⭐
**难度评估：** 低（1/5）
**优先级：** 低
**建议：** 选择代表性强的测试单词

#### 2. 规则拖拽排序功能 ⭐⭐⭐⭐
**需求描述：**
- 支持拖拽改变规则排序
- 排序影响主页规则选择框的顺序

**难度评估：** 中等（3/5）
**优先级：** 中
**技术要点：**
- 需要集成拖拽库（如SortableJS）
- 修改数据存储结构，添加排序字段
- 同步更新主页选择框

### 三、表现性需求

#### 1. 范例显示优化 ⭐⭐⭐
**需求描述：**
- "长度限制"范例置顶
- 格式化范例代码显示
- 解决复制代码后格式混乱问题

**难度评估：** 中等（3/5）
**优先级：** 中
**建议：**
- 使用代码高亮库（如Prism.js或highlight.js）
- 添加代码格式化功能
- 优化复制粘贴体验

#### 2. 已保存规则布局问题 ⭐⭐⭐⭐
**需求描述：**
- 改为水平排布+窄屏自适应
- 修复拖拽后的布局异常

**难度评估：** 中等（3/5）
**优先级：** 高
**技术要点：**
- CSS Grid或Flexbox布局
- 响应式设计
- 拖拽库兼容性问题

### 四、核心逻辑增强

#### 1. 规则注释功能 ✅ **已完成**
**需求描述：**
- 规则名称下方添加注释字段
- 可选，以"//"开始，限制60字符
- 在各处显示时支持截取

**难度评估：** 中等（3/5）
**优先级：** 高
**实现建议：**
- 扩展规则数据结构
- 添加注释输入框
- 实现截取显示逻辑

#### 2. 组合规则非模式 ✅ **已完成**
**需求描述：**
- 当前有&&、||模式
- 需要添加"非"模式
- 推荐符号选择

**难度评估：** 高（4/5）
**优先级：** 高
**符号建议：** `--` 或 `^` 或 `~`
**作用：** 创建"满足前面集合但不满足后面集合"的新集合

#### 3. 匹配规则文档化 ⭐⭐⭐⭐⭐
**需求描述：**
- \m、\-b、\-e等规则的详细说明
- 生成完整的匹配规则文档
- 提供各种范例
- 指出局限性和优化空间

**难度评估：** 高（4/5）
**优先级：** 高
**建议：** 这是核心功能，需要详细的技术文档

## 优先级排序建议

### 高优先级（立即处理）
1. 筛选结果预处理（删除）功能
2. 已保存规则布局问题修复
3. 规则注释功能
4. 组合规则非模式
5. 匹配规则文档化

### 中优先级（后续版本）
1. 规则拖拽排序功能
2. 范例显示优化
3. 规则预览同步问题

### 低优先级（可延后）
1. 排序功能测试与文档
2. 滚动条位置重置
3. 扩展测试规则单词库

## 技术架构建议

### 数据结构扩展
```javascript
// 规则数据结构
{
  name: string,
  comment?: string,  // 新增注释字段
  code: string,
  order: number,     // 新增排序字段
  // ... 其他字段
}

// 筛选结果数据结构
{
  word: string,
  phonetic?: string,
  deleted: boolean,  // 新增删除状态
  // ... 其他字段
}
```

### 开发阶段建议
1. **阶段一：** 核心功能（删除功能、注释功能）
2. **阶段二：** 布局优化（规则布局、范例显示）
3. **阶段三：** 高级功能（拖拽排序、非模式）
4. **阶段四：** 文档完善（匹配规则文档）

## 风险评估

### 高风险项目
- 组合规则非模式：可能影响现有规则引擎
- 规则拖拽排序：可能影响数据一致性

### 中风险项目
- 筛选结果删除功能：需要大量UI交互测试
- 布局问题修复：可能影响现有样式

### 建议
- 每个功能都要充分测试
- 保持向后兼容性
- 及时备份数据结构变更

## 总结

本次需求更新涵盖了功能性、表现性和核心逻辑三个层面，整体工作量较大。建议按优先级分阶段实施，重点关注用户体验和系统稳定性。核心的匹配规则文档化工作尤为重要，建议优先完成。